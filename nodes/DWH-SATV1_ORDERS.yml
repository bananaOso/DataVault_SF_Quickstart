fileVersion: 1
id: 8a6353be-088f-418c-a561-e361ea6ff7cb
name: SATV1_ORDERS
operation:
  config:
    postSQL: ""
    preSQL: ""
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: DWH
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 26b1ff70-4c5b-415c-8857-6b837f1dda57
          stepCounter: 8a6353be-088f-418c-a561-e361ea6ff7cb
        config:
          is_hk: true
        dataType: STRING
        description: ""
        name: SHA1_HUB_ORDER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e9bf8177-f2ee-42c6-8ddb-56474b93bef4
                stepCounter: c315075f-1772-4437-897d-3efcce817fab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 981975ba-8fa1-4561-ab67-590c3371cb3d
          stepCounter: 8a6353be-088f-418c-a561-e361ea6ff7cb
        config: {}
        dataType: STRING
        description: ""
        name: ORDER_HASH_DIFF
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c0772c13-5ae0-4820-aaaa-eb3b38922980
                stepCounter: c315075f-1772-4437-897d-3efcce817fab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ad71e65b-d78d-4c84-9a01-a204e2faa40b
          stepCounter: 8a6353be-088f-418c-a561-e361ea6ff7cb
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: O_ORDERKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 95f91e7c-f21e-4241-b494-85ac7b50038b
                stepCounter: c315075f-1772-4437-897d-3efcce817fab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 35eec0f4-c220-42e2-bb3f-5772a703b03e
          stepCounter: 8a6353be-088f-418c-a561-e361ea6ff7cb
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: O_CUSTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c4d26b7c-1110-4238-a0e6-05de299f61d9
                stepCounter: c315075f-1772-4437-897d-3efcce817fab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 75063d21-b0bd-4f3d-a53b-aa8d4fef81ba
          stepCounter: 8a6353be-088f-418c-a561-e361ea6ff7cb
        config: {}
        dataType: VARCHAR(1)
        description: ""
        name: O_ORDERSTATUS
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c611a26a-cee2-42b3-a355-0ed541c4e78c
                stepCounter: c315075f-1772-4437-897d-3efcce817fab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0e4d25d4-1eda-48b5-9aff-27fc5ba90d0d
          stepCounter: 8a6353be-088f-418c-a561-e361ea6ff7cb
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: O_TOTALPRICE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: adabb597-8247-4cf5-859f-a0b88a965379
                stepCounter: c315075f-1772-4437-897d-3efcce817fab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eaa138a7-4a9a-4b19-9f7c-b7f1a044552d
          stepCounter: 8a6353be-088f-418c-a561-e361ea6ff7cb
        config: {}
        dataType: DATE
        description: ""
        name: O_ORDERDATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bd8e298f-f65a-4ab0-bd22-396e0a9bd21b
                stepCounter: c315075f-1772-4437-897d-3efcce817fab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e3c4af11-f840-4b2e-8444-8cf5363e9d8f
          stepCounter: 8a6353be-088f-418c-a561-e361ea6ff7cb
        config: {}
        dataType: VARCHAR(15)
        description: ""
        name: O_ORDERPRIORITY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a7be8510-9424-423a-bb23-a64c7ba2113e
                stepCounter: c315075f-1772-4437-897d-3efcce817fab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3a7194a6-b67f-42f7-9a2a-577ef92d8524
          stepCounter: 8a6353be-088f-418c-a561-e361ea6ff7cb
        config: {}
        dataType: VARCHAR(15)
        description: ""
        name: O_CLERK
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: edd9ba53-eaf5-4da8-b97a-d1210ed5b465
                stepCounter: c315075f-1772-4437-897d-3efcce817fab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: be001a2e-2b14-41d9-8013-b5560055f6cf
          stepCounter: 8a6353be-088f-418c-a561-e361ea6ff7cb
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: O_SHIPPRIORITY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b6ce7b04-2a72-402d-bf61-7a97e5a1cd59
                stepCounter: c315075f-1772-4437-897d-3efcce817fab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8b490372-1ca1-4358-9c2b-d55ed4931d11
          stepCounter: 8a6353be-088f-418c-a561-e361ea6ff7cb
        config: {}
        dataType: VARCHAR(79)
        description: ""
        name: O_COMMENT
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 74b5a260-2789-4c27-baaa-0f5dcc9c6cec
                stepCounter: c315075f-1772-4437-897d-3efcce817fab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0cbc708b-e363-407f-aadb-d93af1582da2
          stepCounter: 8a6353be-088f-418c-a561-e361ea6ff7cb
        config: {}
        dataType: STRING
        description: The Record Source (RSRC) describes the source of this data.
        name: RSRC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 59ccdabe-9db3-4c72-aadf-accb3f598590
                stepCounter: c315075f-1772-4437-897d-3efcce817fab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e7c3e972-f418-4ac4-bc36-3fa5f1ef2f25
          stepCounter: 8a6353be-088f-418c-a561-e361ea6ff7cb
        config: {}
        dataType: TIMESTAMP
        description: The Load Date Timestamp (LDTS) describes when this data first arrived in the Data Warehouse.
        name: LDTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2c698c3c-cb93-4e3a-9710-e043caa82310
                stepCounter: c315075f-1772-4437-897d-3efcce817fab
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 9fbb09d5-30f8-489a-a90b-6f268b37f556
          stepCounter: 8a6353be-088f-418c-a561-e361ea6ff7cb
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        is_system_ledts: true
        name: LEDTS
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              COALESCE(LEAD("{{ datavault4coalesce.config.ldts_alias }}" - INTERVAL '1 MICROSECOND') 
              OVER (PARTITION BY "{{ get_value_by_column_attribute("is_hk") }}" 
              ORDER BY "{{ datavault4coalesce.config.ldts_alias }}"), {{ datavault4coalesce__string_to_timestamp(datavault4coalesce.config.timestamp_format, datavault4coalesce.config.end_of_all_times) }})
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: c7d55193-0184-465d-a267-ebb38311ea20
          stepCounter: 8a6353be-088f-418c-a561-e361ea6ff7cb
        config: {}
        dataType: BOOLEAN
        defaultValue: ""
        description: ""
        is_system_current_col: true
        name: IS_CURRENT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE 
                WHEN 
                  LEAD("{{ datavault4coalesce.config.ldts_alias }}" - INTERVAL '1 MICROSECOND') 
                  OVER (PARTITION BY "{{ get_value_by_column_attribute("is_hk") }}" 
                  ORDER BY "{{ datavault4coalesce.config.ldts_alias }}") IS NULL 
                THEN TRUE 
                ELSE FALSE 
              END
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DWH
            nodeName: SATV0_ORDERS
        join:
          joinCondition: FROM {{ ref('DWH', 'SATV0_ORDERS') }} "SATV0_ORDERS"
        name: SATV1_ORDERS
        noLinkRefs: []
  name: SATV1_ORDERS
  overrideSQL: false
  schema: ""
  sqlType: data-vault:::9
  type: sql
  version: 1
type: Node
