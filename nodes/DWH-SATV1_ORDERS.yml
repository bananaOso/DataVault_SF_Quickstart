fileVersion: 1
id: 966c46a9-c4c0-4558-b039-9439ee4852c7
name: SATV1_ORDERS
operation:
  config:
    postSQL: ""
    preSQL: ""
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: DWH
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1f98262d-3c69-4b3a-be4a-d3b4b381099b
          stepCounter: 966c46a9-c4c0-4558-b039-9439ee4852c7
        config:
          is_hk: true
        dataType: STRING
        description: ""
        name: SHA1_HUB_ORDER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ec0fad1a-ba0a-487c-bfed-b1ba02cfb953
                stepCounter: d5796d89-54be-40c8-9509-1468c9291acd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ee71a96b-ce57-48c7-b432-72a4acfb97a2
          stepCounter: 966c46a9-c4c0-4558-b039-9439ee4852c7
        config: {}
        dataType: TIMESTAMP
        description: The Load Date Timestamp (LDTS) describes when this data first arrived in the Data Warehouse.
        name: LDTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: afb686a8-7e13-4928-9d10-a5a691976094
                stepCounter: d5796d89-54be-40c8-9509-1468c9291acd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 81dfae50-9a81-45c5-a674-68208c32892b
          stepCounter: 966c46a9-c4c0-4558-b039-9439ee4852c7
        config: {}
        dataType: VARCHAR(1)
        description: ""
        name: O_ORDERSTATUS
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4ba0fd14-1a64-46ee-98b8-1d0a3aa27584
                stepCounter: d5796d89-54be-40c8-9509-1468c9291acd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b924ffa2-b651-4700-8e2a-cc1ced3fbaef
          stepCounter: 966c46a9-c4c0-4558-b039-9439ee4852c7
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: O_TOTALPRICE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c3d67cd7-e70d-4ac7-b1c3-9e2b8dd2347c
                stepCounter: d5796d89-54be-40c8-9509-1468c9291acd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8e5ec6c7-7ef6-4b18-941a-3e346ce30148
          stepCounter: 966c46a9-c4c0-4558-b039-9439ee4852c7
        config: {}
        dataType: DATE
        description: ""
        name: O_ORDERDATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 057721ac-780a-44ce-9a53-91449f8e9348
                stepCounter: d5796d89-54be-40c8-9509-1468c9291acd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1cb18e4e-974e-4b1f-bdea-aa4daa5ee89d
          stepCounter: 966c46a9-c4c0-4558-b039-9439ee4852c7
        config: {}
        dataType: VARCHAR(15)
        description: ""
        name: O_ORDERPRIORITY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8d3d0f30-4af7-4055-937c-462bc875aafc
                stepCounter: d5796d89-54be-40c8-9509-1468c9291acd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0b8785d7-db68-4497-858b-144ee17bc746
          stepCounter: 966c46a9-c4c0-4558-b039-9439ee4852c7
        config: {}
        dataType: VARCHAR(15)
        description: ""
        name: O_CLERK
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ac822f39-f59d-4d0e-97db-c4b40aa86621
                stepCounter: d5796d89-54be-40c8-9509-1468c9291acd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c56095c8-2524-4b12-88f7-ca7aee167ba4
          stepCounter: 966c46a9-c4c0-4558-b039-9439ee4852c7
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: O_SHIPPRIORITY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f419b77f-45fd-4fcd-a0a3-0df44be7367a
                stepCounter: d5796d89-54be-40c8-9509-1468c9291acd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9fb6c7b2-2534-457b-96e0-017dc81587c1
          stepCounter: 966c46a9-c4c0-4558-b039-9439ee4852c7
        config: {}
        dataType: VARCHAR(79)
        description: ""
        name: O_COMMENT
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c9c07992-b004-4946-80a0-99d98696d36c
                stepCounter: d5796d89-54be-40c8-9509-1468c9291acd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1a435148-eadf-4651-a9a5-5aa48eb77d83
          stepCounter: 966c46a9-c4c0-4558-b039-9439ee4852c7
        config: {}
        dataType: STRING
        description: ""
        name: ORDER_HASH_DIFF
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cfe3a74e-4227-4c97-bb09-a4704e104d17
                stepCounter: d5796d89-54be-40c8-9509-1468c9291acd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5c867cdb-444b-4c9f-a604-974e52385038
          stepCounter: 966c46a9-c4c0-4558-b039-9439ee4852c7
        config: {}
        dataType: STRING
        description: The Record Source (RSRC) describes the source of this data.
        name: RSRC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e7260b13-d87f-4e46-a874-4c6accda2fbb
                stepCounter: d5796d89-54be-40c8-9509-1468c9291acd
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 90052e23-4c60-495e-8982-75e3ad94fb27
          stepCounter: 966c46a9-c4c0-4558-b039-9439ee4852c7
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        is_system_ledts: true
        name: LEDTS
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              COALESCE(LEAD("{{ datavault4coalesce.config.ldts_alias }}" - INTERVAL '1 MICROSECOND') 
              OVER (PARTITION BY "{{ get_value_by_column_attribute("is_hk") }}" 
              ORDER BY "{{ datavault4coalesce.config.ldts_alias }}"), {{ datavault4coalesce__string_to_timestamp(datavault4coalesce.config.timestamp_format, datavault4coalesce.config.end_of_all_times) }})
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 0227175e-ecbb-4c21-ab32-5eda3705d831
          stepCounter: 966c46a9-c4c0-4558-b039-9439ee4852c7
        config: {}
        dataType: BOOLEAN
        defaultValue: ""
        description: ""
        is_system_current_col: true
        name: IS_CURRENT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE 
                WHEN 
                  LEAD("{{ datavault4coalesce.config.ldts_alias }}" - INTERVAL '1 MICROSECOND') 
                  OVER (PARTITION BY "{{ get_value_by_column_attribute("is_hk") }}" 
                  ORDER BY "{{ datavault4coalesce.config.ldts_alias }}") IS NULL 
                THEN TRUE 
                ELSE FALSE 
              END
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DWH
            nodeName: SATV0_ORDERS
        join:
          joinCondition: FROM {{ ref('DWH', 'SATV0_ORDERS') }} "SATV0_ORDERS"
        name: SATV1_ORDERS
        noLinkRefs: []
  name: SATV1_ORDERS
  overrideSQL: false
  schema: ""
  sqlType: data-vault:::9
  type: sql
  version: 1
type: Node
