fileVersion: 1
id: 287d31ab-6e4b-45c3-bce1-b97a52c30f6d
name: V_ORDERS
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: DWH
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b4cea7f5-96f7-4c8f-9d8f-acd67b1bb4b6
          stepCounter: 287d31ab-6e4b-45c3-bce1-b97a52c30f6d
        config: {}
        dataType: STRING
        description: ""
        name: SHA1_HUB_ORDER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ec0fad1a-ba0a-487c-bfed-b1ba02cfb953
                stepCounter: d5796d89-54be-40c8-9509-1468c9291acd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 76dd9937-0cd9-4b26-a47c-72177353ed07
          stepCounter: 287d31ab-6e4b-45c3-bce1-b97a52c30f6d
        config: {}
        dataType: TIMESTAMP
        description: The Load Date Timestamp (LDTS) describes when this data first arrived in the Data Warehouse.
        name: LDTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: afb686a8-7e13-4928-9d10-a5a691976094
                stepCounter: d5796d89-54be-40c8-9509-1468c9291acd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c070159a-5b92-4687-a360-3d7267795f91
          stepCounter: 287d31ab-6e4b-45c3-bce1-b97a52c30f6d
        config: {}
        dataType: VARCHAR(1)
        description: ""
        name: O_ORDERSTATUS
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4ba0fd14-1a64-46ee-98b8-1d0a3aa27584
                stepCounter: d5796d89-54be-40c8-9509-1468c9291acd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: de2a1f77-cfd4-4ba3-becc-dc4a3ec86296
          stepCounter: 287d31ab-6e4b-45c3-bce1-b97a52c30f6d
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: O_TOTALPRICE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c3d67cd7-e70d-4ac7-b1c3-9e2b8dd2347c
                stepCounter: d5796d89-54be-40c8-9509-1468c9291acd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 11db45d4-a4f6-4263-8176-746af371816a
          stepCounter: 287d31ab-6e4b-45c3-bce1-b97a52c30f6d
        config: {}
        dataType: DATE
        description: ""
        name: O_ORDERDATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 057721ac-780a-44ce-9a53-91449f8e9348
                stepCounter: d5796d89-54be-40c8-9509-1468c9291acd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0eb5abed-b447-463e-a2fc-4887b16b26d4
          stepCounter: 287d31ab-6e4b-45c3-bce1-b97a52c30f6d
        config: {}
        dataType: VARCHAR(15)
        description: ""
        name: O_ORDERPRIORITY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8d3d0f30-4af7-4055-937c-462bc875aafc
                stepCounter: d5796d89-54be-40c8-9509-1468c9291acd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f80459b9-5f61-4afe-8a61-dfbdb233ad2c
          stepCounter: 287d31ab-6e4b-45c3-bce1-b97a52c30f6d
        config: {}
        dataType: VARCHAR(15)
        description: ""
        name: O_CLERK
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ac822f39-f59d-4d0e-97db-c4b40aa86621
                stepCounter: d5796d89-54be-40c8-9509-1468c9291acd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d801e09b-7d47-4abf-aadb-01c7c3b3afe0
          stepCounter: 287d31ab-6e4b-45c3-bce1-b97a52c30f6d
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: O_SHIPPRIORITY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f419b77f-45fd-4fcd-a0a3-0df44be7367a
                stepCounter: d5796d89-54be-40c8-9509-1468c9291acd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ab5c4a20-06e4-4cd9-ae20-2e66f448ed6c
          stepCounter: 287d31ab-6e4b-45c3-bce1-b97a52c30f6d
        config: {}
        dataType: VARCHAR(79)
        description: ""
        name: O_COMMENT
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c9c07992-b004-4946-80a0-99d98696d36c
                stepCounter: d5796d89-54be-40c8-9509-1468c9291acd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6c55f7b6-ddaf-4097-83ad-f05aa7fc12f3
          stepCounter: 287d31ab-6e4b-45c3-bce1-b97a52c30f6d
        config: {}
        dataType: STRING
        description: ""
        name: ORDER_HASH_DIFF
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cfe3a74e-4227-4c97-bb09-a4704e104d17
                stepCounter: d5796d89-54be-40c8-9509-1468c9291acd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ae816f27-3b7c-47d7-a091-87aa6f939467
          stepCounter: 287d31ab-6e4b-45c3-bce1-b97a52c30f6d
        config: {}
        dataType: STRING
        description: The Record Source (RSRC) describes the source of this data.
        name: RSRC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e7260b13-d87f-4e46-a874-4c6accda2fbb
                stepCounter: d5796d89-54be-40c8-9509-1468c9291acd
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 2b80a80c-642f-4eab-86ce-22d5b6544e62
          stepCounter: 287d31ab-6e4b-45c3-bce1-b97a52c30f6d
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: ORDER_PRIORITY_BUCKET
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: |+
              CASE
                 WHEN O_ORDERPRIORITY IN ('2-HIGH', '1-URGENT')            
                 AND O_TOTALPRICE >= 200000
                 THEN 'Tier-1'


                 WHEN O_ORDERPRIORITY IN ('3-MEDIUM', '2-HIGH', '1-URGENT')
                 AND O_TOTALPRICE BETWEEN 150000 AND 200000
                 THEN 'Tier-2' 
                
                 ELSE 'Tier-3'
              END



        systemColumnType: None
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DWH
            nodeName: SATV0_ORDERS
        join:
          joinCondition: FROM {{ ref('DWH', 'SATV0_ORDERS') }} "SATV0_ORDERS"
        name: V_ORDERS
        noLinkRefs: []
  name: V_ORDERS
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
