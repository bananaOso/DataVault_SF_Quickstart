fileVersion: 1
id: e23714f6-f669-45a9-82aa-acc4bcf6449c
name: STG_CUSTOMER_DV
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: DWH
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e7373ab0-f7ca-48b2-8c12-f474a12dd066
          stepCounter: e23714f6-f669-45a9-82aa-acc4bcf6449c
        config: {}
        dataType: VARCHAR(25)
        description: ""
        name: C_NAME
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 65c4a8db-4eac-42fd-9760-25f0aa58060d
                stepCounter: 315919d4-bb42-4918-a26d-7b174975635d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1713b7e4-cef9-4082-85c4-4bbd0ecb9941
          stepCounter: e23714f6-f669-45a9-82aa-acc4bcf6449c
        config: {}
        dataType: VARCHAR(40)
        description: ""
        name: C_ADDRESS
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 00abc8b9-750e-4ea0-828c-702730134440
                stepCounter: 315919d4-bb42-4918-a26d-7b174975635d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9ed48676-56e6-4eae-bad8-a300c143e7f9
          stepCounter: e23714f6-f669-45a9-82aa-acc4bcf6449c
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: C_NATIONKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ca8441a3-15cd-47cd-ad2d-cbd8c2bafa29
                stepCounter: 315919d4-bb42-4918-a26d-7b174975635d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 970517a4-4519-4c81-9a5f-b6650434b0d2
          stepCounter: e23714f6-f669-45a9-82aa-acc4bcf6449c
        config: {}
        dataType: VARCHAR(15)
        description: ""
        name: C_PHONE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4e1000b4-32db-4721-a7c7-90878313e6cb
                stepCounter: 315919d4-bb42-4918-a26d-7b174975635d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 793a2616-1c72-488b-9fb2-8dbcef841d50
          stepCounter: e23714f6-f669-45a9-82aa-acc4bcf6449c
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: C_ACCTBAL
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8ff63a60-e920-4afa-8c54-6af2bf7a12e1
                stepCounter: 315919d4-bb42-4918-a26d-7b174975635d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e3a5f2a7-d9db-48d3-9cb2-a0f8d32d9047
          stepCounter: e23714f6-f669-45a9-82aa-acc4bcf6449c
        config: {}
        dataType: VARCHAR(10)
        description: ""
        name: C_MKTSEGMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ae77a455-ddf4-4a90-82e7-f7d7e7c96592
                stepCounter: 315919d4-bb42-4918-a26d-7b174975635d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1c903c7f-6a53-45f5-ab6f-8287179a9900
          stepCounter: e23714f6-f669-45a9-82aa-acc4bcf6449c
        config: {}
        dataType: VARCHAR(117)
        description: ""
        name: C_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 69516573-9227-4fb4-9f48-ea00235500d6
                stepCounter: 315919d4-bb42-4918-a26d-7b174975635d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dd8868ca-db15-4703-81ea-2640193a3ad7
          stepCounter: e23714f6-f669-45a9-82aa-acc4bcf6449c
        config: {}
        dataType: TIMESTAMP
        description: ""
        name: LEDTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: af18617c-cd97-4bb7-bec9-77efcc8db7f1
                stepCounter: 315919d4-bb42-4918-a26d-7b174975635d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 65374062-8828-4280-a13c-998f545311b4
          stepCounter: e23714f6-f669-45a9-82aa-acc4bcf6449c
        config: {}
        dataType: BOOLEAN
        description: ""
        name: IS_CURRENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 37a3e063-27bf-48f3-9498-e7c949b918a9
                stepCounter: 315919d4-bb42-4918-a26d-7b174975635d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a4c4f365-bb55-4860-87c1-989899152a6f
          stepCounter: e23714f6-f669-45a9-82aa-acc4bcf6449c
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: C_CUSTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c4ce0a6f-7a3c-4c58-b4ea-0edc5ef28ab4
                stepCounter: 05f5eea9-e351-4634-8af8-c0e6e6371197
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 97df0ed4-35b6-422b-acee-8e1f08f7a6ab
          stepCounter: e23714f6-f669-45a9-82aa-acc4bcf6449c
        config: {}
        dataType: TIMESTAMP
        description: The Load Date Timestamp (LDTS) describes when this data first arrived in the Data Warehouse.
        name: LDTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3893967c-f9eb-4bf3-b243-76ea22156ba5
                stepCounter: 05f5eea9-e351-4634-8af8-c0e6e6371197
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8c88fa34-5567-4f2c-bd2b-d38a1cf63654
          stepCounter: e23714f6-f669-45a9-82aa-acc4bcf6449c
        config: {}
        dataType: STRING
        description: The Record Source (RSRC) describes the source of this data.
        name: RSRC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3fd0f5dc-be0d-4025-a046-08453b993cfe
                stepCounter: 05f5eea9-e351-4634-8af8-c0e6e6371197
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 4aae5a3e-369e-4cf8-aa26-9224048d0045
          stepCounter: e23714f6-f669-45a9-82aa-acc4bcf6449c
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: C_CREDIT_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: CASE WHEN "SATV1_CUSTOMER"."C_ACCTBAL" > 5000 AND "SATV1_CUSTOMER"."C_MKTSEGMENT" IN ('FURNITURE','AUTOMOBILE') THEN 'HIGH' ELSE 'LOW' END
        systemColumnType: None
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          HUB_CUSTOMER: 05f5eea9-e351-4634-8af8-c0e6e6371197
          SATV1_CUSTOMER: 315919d4-bb42-4918-a26d-7b174975635d
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DWH
            nodeName: HUB_CUSTOMER
          - locationName: DWH
            nodeName: SATV1_CUSTOMER
        join:
          joinCondition: |-
            FROM {{ ref('DWH', 'SATV1_CUSTOMER') }} "SATV1_CUSTOMER"
            INNER JOIN {{ ref('DWH', 'HUB_CUSTOMER') }} "HUB_CUSTOMER"
            ON "SATV1_CUSTOMER"."HK_CUSTOMER" = "HUB_CUSTOMER"."HK_CUSTOMER"
            where "SATV1_CUSTOMER"."IS_CURRENT" = true
        name: STG_CUSTOMER_DV
        noLinkRefs: []
  name: STG_CUSTOMER_DV
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
